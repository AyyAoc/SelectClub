# ระบบจัดสรรชมรมนักศึกษา (SelectClub)

ระบบจัดสรรชมรมนักศึกษาอัตโนมัติที่คำนึงถึงความต้องการของนักศึกษา ความสมดุลของกลุ่ม และความเหมาะสมของระยะทางในการเดินระหว่างชมรม

## ภาพรวมระบบ

SelectClub เป็นชุดเครื่องมือสำหรับการจัดสรรนักศึกษาเข้าชมรมต่างๆ ตามความต้องการ โดยคำนึงถึงเงื่อนไขสำคัญคือ:
- นักศึกษาได้เข้าร่วมชมรมที่เลือกไว้มากที่สุด (เลือกหลัก 1-4 และเลือกสำรอง 5-8)
- ทุกชมรมมีตัวแทนนักศึกษาจากทุกกลุ่ม (กลุ่ม 0-9 ตามตัวเลขสุดท้ายของรหัสนักศึกษา)
- จำนวนนักศึกษาในแต่ละชมรมไม่เกิน 20 คน (ยกเว้นกรณีพิเศษ)
- ลดระยะทางในการเดินระหว่างชมรมให้น้อยที่สุด

## ไฟล์ในโปรเจค

โปรเจคประกอบด้วยไฟล์หลัก 4 ไฟล์:

### 1. club_allocation_optimal.py
ไฟล์หลักสำหรับการจัดสรรนักศึกษาเข้าชมรมด้วยวิธี Global Optimization

**ฟังก์ชันหลัก:**
- `optimize_club_allocation()` - ฟังก์ชันหลักสำหรับการจัดสรรชมรม
- `initial_assignment()` - จัดสรรชมรมเบื้องต้นตามความต้องการหลัก
- `check_group_representation()` - ตรวจสอบว่าทุกชมรมมีตัวแทนจากทุกกลุ่มหรือไม่
- `adjust_assignments()` - ปรับปรุงการจัดสรรเพื่อให้มีตัวแทนจากทุกกลุ่มในทุกชมรม
- `calculate_statistics()` - คำนวณสถิติต่างๆ จากผลการจัดสรร
- `save_results()` - บันทึกผลลัพธ์การจัดสรรลงไฟล์ CSV

### 2. group_distribution_report.py
ไฟล์สำหรับวิเคราะห์และแสดงรายงานการกระจายตัวของนักศึกษาแต่ละกลุ่มในแต่ละชมรม

**ฟังก์ชันหลัก:**
- `load_assignments()` - โหลดข้อมูลการจัดสรรชมรมจากไฟล์ CSV
- `analyze_club_distribution()` - วิเคราะห์การกระจายตัวของนักศึกษาในแต่ละชมรมและแต่ละกลุ่ม
- `print_distribution_report()` - แสดงผลรายงานการกระจายตัวของนักศึกษา

### 3. Pathoptimize.py
ไฟล์สำหรับปรับปรุงเส้นทางการเดินของนักศึกษาระหว่างชมรมต่างๆ โดยใช้ข้อมูลพิกัดทางภูมิศาสตร์

**ฟังก์ชันหลัก:**
- `calculate_distance()` - คำนวณระยะทางระหว่างสองตำแหน่งโดยใช้สูตร Haversine
- `calculate_student_total_distance()` - คำนวณระยะทางรวมในการเดินของนักศึกษาแต่ละคน
- `find_best_swaps()` - ค้นหาการสลับช่วงเวลาที่ให้ประโยชน์มากที่สุด
- `perform_swaps()` - ดำเนินการสลับตามลำดับผลประโยชน์สูงสุด
- `save_optimized_assignments()` - บันทึกข้อมูลการจัดสรรที่ปรับปรุงแล้ว

### 4. show_club_stats.py
ไฟล์สำหรับแสดงสถิติจำนวนนักศึกษาในแต่ละชมรมและช่วงเวลา

**ฟังก์ชันหลัก:**
- `load_assignment_results()` - โหลดข้อมูลการจัดสรรชมรม
- `count_club_members()` - นับจำนวนนักศึกษาในแต่ละชมรมในแต่ละช่วงเวลา
- `print_club_stats()` - แสดงผลสถิติชมรมในแต่ละช่วงเวลา

## ขั้นตอนการใช้งาน

1. **จัดสรรนักศึกษาเข้าชมรม**:
   ```
   python club_allocation_optimal.py
   ```
   ผลลัพธ์จะถูกบันทึกในไฟล์ `club_assignment_results_optimal.csv`

2. **ตรวจสอบสถิติชมรม**:
   ```
   python show_club_stats.py
   ```
   แสดงจำนวนนักศึกษาในแต่ละชมรมและช่วงเวลา พร้อมระบุชมรมที่มีนักศึกษาเกิน 20 คน (⚠️) และชมรมที่ไม่มีนักศึกษา (❌)

3. **ตรวจสอบการกระจายตัวของกลุ่ม**:
   ```
   python group_distribution_report.py
   ```
   แสดงรายงานการกระจายตัวของนักศึกษาแต่ละกลุ่ม (0-9) ในแต่ละชมรม

4. **ปรับปรุงเส้นทางการเดิน**:
   ```
   python Pathoptimize.py
   ```
   ปรับปรุงการจัดสรรโดยการสลับช่วงเวลาเพื่อลดระยะทางการเดินโดยรวม ผลลัพธ์จะถูกบันทึกในไฟล์ `optimized_path_assignments.csv`

## รูปแบบข้อมูลนำเข้า

โปรแกรมใช้ไฟล์ CSV ที่มีคอลัมน์ดังนี้:

1. `รหัสนักศึกษา`: รหัสประจำตัวนักศึกษา
2. `ชื่อ นามสกุล`: ชื่อและนามสกุลของนักศึกษา
3. `ฐานเช้า อันดับที่ 1-8`: ชื่อชมรมที่นักศึกษาต้องการเข้าร่วมช่วงเช้า 
   - อันดับ 1-4: ชมรมหลักที่ต้องการ
   - อันดับ 5-8: ชมรมสำรองที่ต้องการ
4. `ฐานบ่าย อันดับที่ 1-8`: ชื่อชมรมที่นักศึกษาต้องการเข้าร่วมช่วงบ่าย
   - อันดับ 1-4: ชมรมหลักที่ต้องการ
   - อันดับ 5-8: ชมรมสำรองที่ต้องการ

## รูปแบบข้อมูลส่งออก

1. **club_assignment_results_optimal.csv**: ผลการจัดสรรชมรมเบื้องต้น
   - แสดงรายชื่อนักศึกษาและชมรมที่ได้รับในแต่ละช่วงเวลา (4 ช่วงเช้า, 4 ช่วงบ่าย)
   - แยกตามกลุ่มนักศึกษา

2. **optimized_path_assignments.csv**: ผลการจัดสรรที่ปรับปรุงเส้นทางแล้ว
   - แสดงผลการจัดสรรที่ลดระยะทางการเดินโดยรวม
   - ยังคงรักษาการจัดสรรชมรมเดิม เพียงสลับช่วงเวลาเท่านั้น

## ระบบการจัดสรรชมรม

ระบบใช้อัลกอริทึมที่ซับซ้อนในการจัดสรรนักศึกษาเข้าชมรม โดยมีขั้นตอนดังนี้:

1. **การจัดสรรเบื้องต้น**:
   - จัดสรรนักศึกษาตามความต้องการหลัก (อันดับ 1-4)
   - ตรวจสอบว่าทุกชมรมมีตัวแทนจากทุกกลุ่มหรือไม่

2. **การปรับปรุงการจัดสรร**:
   - หากมีกลุ่มที่ยังไม่มีตัวแทนในชมรมใด จะเพิ่มนักศึกษาจากกลุ่มนั้นเข้าไป
   - ชมรมที่มีผู้สนใจมากกว่า 20 คน จะใช้ระบบคะแนนความยุติธรรม (Fairness Score) ในการเลือก
   - ระบบคะแนนจะพิจารณาจากลำดับความต้องการ จำนวนชมรมที่ได้รับแล้ว และการเป็นตัวแทนกลุ่ม

3. **การปรับปรุงเส้นทาง**:
   - หลังจากจัดสรรเสร็จแล้ว จะปรับปรุงเส้นทางการเดินโดยสลับช่วงเวลา
   - ใช้ข้อมูลพิกัดของอาคารที่ชมรมตั้งอยู่ในการคำนวณระยะทาง
   - สลับช่วงเวลาเฉพาะคู่ที่ทำให้ระยะทางลดลงโดยไม่กระทบการจัดสรรชมรม

## ข้อจำกัดและหมายเหตุ

1. **จำนวนนักศึกษา**: ชมรมอาจมีนักศึกษาเกิน 20 คนในบางกรณี เพื่อให้มีตัวแทนจากทุกกลุ่ม
2. **ลำดับความสำคัญ**: ระบบให้ความสำคัญกับการมีตัวแทนกลุ่มมากกว่าการจำกัดจำนวน 20 คน
3. **การปรับปรุงเส้นทาง**: การปรับปรุงเส้นทางไม่เปลี่ยนแปลงชมรมที่นักศึกษาได้รับ เพียงแต่สลับช่วงเวลา
4. **พิกัดชมรม**: ใช้พิกัดภูมิศาสตร์จริงของแต่ละอาคารในการคำนวณระยะทาง
5. **ไฟล์ข้อมูล**: ค่าเริ่มต้นใช้ไฟล์ `test_250.csv` สามารถเปลี่ยนได้ในโค้ด
